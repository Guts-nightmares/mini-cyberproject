# Quick Start - HID Scripts pour Lab Personnel

Guide rapide pour utiliser les scripts HID dans votre laboratoire personnel.

## IMPORTANT

Ces scripts sont destines UNIQUEMENT a:
- Votre laboratoire personnel
- Vos propres machines
- Engagements avec autorisation ecrite explicite

L'usage non autorise est ILLEGAL.

---

## Setup Initial

### 1. Preparer le Script de Diagnostic

**Sur votre machine de lab (Linux/macOS):**

```bash
# Copier le script de diagnostic
cp payloads/diagnostics/lab-diagnostic.sh /tmp/

# Rendre executable
chmod +x /tmp/lab-diagnostic.sh

# Tester manuellement
bash /tmp/lab-diagnostic.sh
```

**Sur votre machine de lab (Windows):**

```powershell
# Copier le script
Copy-Item payloads\diagnostics\lab-diagnostic.ps1 -Destination $env:TEMP\diagnostic.ps1

# Tester manuellement
powershell -ExecutionPolicy Bypass $env:TEMP\diagnostic.ps1
```

### 2. Preparer le Flipper Zero

**Configuration:**

1. **Inserer carte microSD dans Flipper Zero**

2. **Copier les scripts HID:**
   ```
   - Connecter Flipper en mode Storage (USB)
   - Copier scripts .txt vers: /badusb/

   Exemple:
   FLIPPER_DRIVE/badusb/lab-diagnostic-linux.txt
   FLIPPER_DRIVE/badusb/lab-diagnostic-windows.txt
   ```

3. **Deconnecter et redemarrer Flipper**

---

## Utilisation dans votre Lab

### Scenario 1: Diagnostic Automatise (Linux/macOS)

**Objectif:** Executer automatiquement un script de diagnostic sur votre machine de lab.

**Etapes:**

1. **Preparer la machine:**
   ```bash
   # S'assurer que le script est en place
   ls -la /tmp/lab-diagnostic.sh

   # Deverrouiller l'ecran
   # Ouvrir un espace de travail vide
   ```

2. **Sur le Flipper Zero:**
   ```
   Navigation:
   Bad USB > lab-diagnostic-linux.txt > Press (bouton central)
   ```

3. **Brancher le Flipper en USB sur votre machine**

4. **Observer l'execution:**
   - Terminal s'ouvre automatiquement
   - Script s'execute
   - Resultats s'affichent

5. **Resultat:**
   - Rapport sauvegarde dans /tmp/lab-diagnostic-YYYYMMDD-HHMMSS.txt

### Scenario 2: Diagnostic Automatise (Windows)

**Objectif:** Executer automatiquement un script de diagnostic sur votre PC Windows de lab.

**Etapes:**

1. **Preparer la machine:**
   ```powershell
   # Verifier le script
   Test-Path $env:TEMP\diagnostic.ps1

   # Deverrouiller l'ecran
   ```

2. **Sur le Flipper Zero:**
   ```
   Bad USB > lab-diagnostic-windows.txt > Press
   ```

3. **Brancher le Flipper en USB**

4. **Observer l'execution:**
   - PowerShell s'ouvre
   - Script s'execute
   - Resultats s'affichent

5. **Resultat:**
   - Rapport dans %TEMP%\lab-diagnostic-YYYYMMDD-HHMMSS.txt

### Scenario 3: Enumeration Basique

**Objectif:** Collecter rapidement des informations systeme.

**Etapes:**

1. **Sur le Flipper:**
   ```
   Bad USB > system-enum-basic.txt > Press
   ```

2. **Brancher sur la machine**

3. **Resultats:**
   - Fichier /tmp/enum.txt cree
   - Informations affichees a l'ecran

---

## Personnalisation des Scripts

### Modifier un Script Flipper

**Exemple: Changer le chemin du script de diagnostic**

**Fichier:** `hid-scripts/flipper-zero/lab-diagnostic-linux.txt`

```
REM Original
STRING if [ -f /tmp/lab-diagnostic.sh ]; then bash /tmp/lab-diagnostic.sh; else echo "Script not found"; fi

REM Modifier pour autre chemin
STRING if [ -f /home/user/scripts/my-diagnostic.sh ]; then bash /home/user/scripts/my-diagnostic.sh; else echo "Script not found"; fi
```

**Sauvegarder et copier sur Flipper Zero**

### Ajouter des Commandes

**Exemple: Ajouter une commande au diagnostic**

**Fichier:** `payloads/diagnostics/lab-diagnostic.sh`

```bash
# Ajouter apres la section "BASIC INFORMATION"

echo "=== CUSTOM CHECK ==="
echo "Docker status:"
docker ps 2>/dev/null || echo "Docker not running"
echo ""
```

---

## Troubleshooting

### Le script HID ne s'execute pas

**Problemes courants:**

1. **Mauvais layout clavier:**
   ```
   Flipper Zero utilise US keyboard layout par defaut

   Si votre machine utilise AZERTY:
   - Changer temporairement en QWERTY
   - OU modifier le script pour AZERTY
   ```

2. **Timing trop rapide:**
   ```
   Augmenter les DELAY dans le script

   Exemple:
   DELAY 1000  -> DELAY 2000
   ```

3. **Terminal ne s'ouvre pas:**
   ```
   Methode alternative (Linux):
   CTRL-ALT t   # Au lieu de GUI SPACE + terminal

   Methode alternative (macOS):
   CMD SPACE
   STRING iterm
   ```

### Le script de diagnostic ne se trouve pas

**Solution:**

```bash
# Verifier l'emplacement
ls -la /tmp/lab-diagnostic.sh

# Si absent, le recreer
cp payloads/diagnostics/lab-diagnostic.sh /tmp/
chmod +x /tmp/lab-diagnostic.sh
```

### Erreurs de permissions (PowerShell)

**Solution:**

```powershell
# Autoriser execution temporairement
Set-ExecutionPolicy -Scope CurrentUser -ExecutionPolicy Bypass

# Ou executer avec bypass
powershell -ExecutionPolicy Bypass .\diagnostic.ps1
```

---

## Testing Securise

### Dans votre Lab Personnel

**Bonnes pratiques:**

1. **Machines virtuelles:**
   - Tester d'abord sur VMs
   - Snapshots avant test
   - Environnement isole

2. **Documentation:**
   ```bash
   # Logger vos tests
   python utilities/engagement-logger.py --start "Lab-HID-Testing"

   python utilities/engagement-logger.py --log "HID test on Ubuntu VM" \
       --category physical-security \
       --target "Lab-VM-Ubuntu-01" \
       --details "Flipper Zero script executed successfully, diagnostic completed in 45s"
   ```

3. **Nettoyage:**
   ```bash
   # Supprimer fichiers de test
   rm /tmp/lab-diagnostic-*.txt
   rm /tmp/enum.txt

   # Windows
   Remove-Item $env:TEMP\lab-diagnostic-*.txt
   ```

---

## Passage a un Engagement Reel

### Avant d'utiliser sur un engagement client

**Checklist:**

- [ ] Autorisation ECRITE obtenue
- [ ] Scope include explicitement "physical security testing"
- [ ] Scope include "USB device testing" ou "HID attacks"
- [ ] Scripts testes dans environnement similaire
- [ ] Contact d'urgence client defini
- [ ] Procedures d'escalade etablies

### Adapter les Scripts

**Pour un engagement client:**

1. **Tester sur environnement similaire:**
   - Meme OS
   - Meme configuration clavier
   - Memes controles de securite

2. **Minimiser l'impact:**
   - Scripts rapides (<60s)
   - Pas de modifications persistantes
   - Cleanup automatique

3. **Documentation:**
   - Logger CHAQUE test
   - Timestamps precis
   - Photos/videos si autorise

**Exemple de script adapte pour client:**

```
REM Client Engagement - Physical Security Test
REM Authorization: ENG-2024-001
REM Date: 2024-01-15

DELAY 2000

REM Open terminal
GUI SPACE
DELAY 500
STRING terminal
DELAY 500
ENTER
DELAY 2000

REM Quick enumeration (non-invasive)
STRING echo "Test ID: ENG-2024-001" > /tmp/test-$(date +%s).txt
ENTER
DELAY 200

STRING echo "Hostname: $(hostname)" >> /tmp/test-$(date +%s).txt
ENTER
DELAY 200

STRING echo "User: $(whoami)" >> /tmp/test-$(date +%s).txt
ENTER
DELAY 200

REM Display and cleanup
STRING cat /tmp/test-*.txt && rm /tmp/test-*.txt
ENTER
```

---

## Integration avec le Toolkit

### Workflow Complet

```bash
# 1. Initialiser l'engagement
python utilities/engagement-logger.py --start "Client-PhysSec-2024"

# 2. Charger le scope
python utilities/scope-manager.py --load physical-scope.txt

# 3. Executer tests HID
# (utiliser Flipper Zero sur cibles autorisees)

# 4. Logger chaque test
python utilities/engagement-logger.py --log "HID test successful" \
    --category physical-security \
    --target "Building A, Floor 2, Workstation 15"

# 5. Ajouter findings au rapport
python reporting/report-generator.py --add-finding \
    --title "Workstations vulnerable to HID attacks" \
    --severity high

# 6. Generer rapport
python reporting/report-generator.py --generate --format html

# 7. Terminer engagement
python utilities/engagement-logger.py --end
```

---

## Resources Additionnelles

### Documentation

- **Flipper Zero:** https://docs.flipperzero.one/
- **Hak5 Ducky Script:** https://docs.hak5.org/hak5-usb-rubber-ducky/
- **Physical Pentest Guide:** `documentation/physical-pentest-methodology.md`

### Communautes

- **Flipper Zero Discord**
- **Hak5 Forums**
- **r/flipperzero (Reddit)**

### Formations

- **Hak5 Field Guide**
- **Seytonic YouTube Channel**
- **Physical Security Courses (SANS, Offensive Security)**

---

## Rappel Legal

**Usage autorise uniquement:**
- Votre propre laboratoire
- Vos propres machines
- Engagements avec autorisation ECRITE explicite

**Usage non autorise = ILLEGAL**

Soyez professionnel. Soyez ethique. Soyez legal.
